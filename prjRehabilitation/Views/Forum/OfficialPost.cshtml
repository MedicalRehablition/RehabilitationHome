<section class="blog_area section-padding">
    <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mb-5 mb-lg-0">
                <div class="blog_left_sidebar" id="div_article">



                </div>
                <nav class="blog-pagination justify-content-center d-flex">
                    <ul class="pagination">
                        <li class="page-item">
                            <a href="#" class="page-link" aria-label="Previous">
                                <i class="ti-angle-left"></i>
                            </a>
                        </li>
                        <li class="page-item">
                            <a href="#" class="page-link">1</a>
                        </li>
                        <li class="page-item active">
                            <a href="#" class="page-link">2</a>
                        </li>
                        <li class="page-item">
                            <a href="#" class="page-link" aria-label="Next">
                                <i class="ti-angle-right"></i>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="col-lg-4">
                <div class="blog_right_sidebar">
                    <aside class="single_sidebar_widget search_widget">

                            <div class="form-group">
                                <div class="input-group mb-3">
                                    <input type="text" id="keyword" class="form-control" placeholder="Search Keyword" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Search Keyword'">
                                    <div class="input-group-append">
                                        <button onclick="searchByKeyword()" class="btns" type="button"><i class="ti-search"></i></button>
                                    </div>
                                </div>
                            </div>
                        <button class="genric button rounded-0 primary-bg text-black w-100 btn_1 boxed-btn" onclick="searchByKeyword()" type="button">Search</button>
                    </aside>
                    <aside class="single_sidebar_widget post_category_widget">
                        <h4 class="widget_title" style="color: #2d2d2d;">目錄</h4>
                        <ul class="list cat-list">
                            <li>
                                <a onclick="searchByTag('QA')" class="d-flex">
                                    <p>QA</p>
                                    <p>(37)</p>
                                </a>
                            </li>
                            <li>
                                <a onclick="searchByTag('介紹')" class="d-flex">
                                    <p>介紹</p>
                                    <p>(10)</p>
                                </a>
                            </li>
                            <li>
                                <a onclick ="searchByTag('用藥')" class="d-flex">
                                    <p>用藥</p>
                                    <p>(03)</p>
                                </a>
                            </li>
                            <li>
                                <a onclick="searchByTag('復健')" class="d-flex">
                                    <p>復健</p>
                                    <p>(11)</p>
                                </a>
                            </li>
                            <li>
                                <a onclick="searchByTag('技術')" class="d-flex">
                                    <p>技術</p>
                                    <p>(21)</p>
                                </a>
                            </li>
                            <li>
                                <a onclick="searchByTag('公告')" class="d-flex">
                                    <p>公告</p>
                                    <p>(21)</p>
                                </a>
                            </li>
                            <li>
                                <a onclick="searchByTag('活動')"  class="d-flex">
                                    <p>活動</p>
                                    <p>(21)</p>
                                </a>
                            </li>
                        </ul>
                    </aside>
                    <aside class="single_sidebar_widget popular_post_widget">
                        <h3 class="widget_title" style="color: #2d2d2d;">Recent Post</h3>
                        <div class="media post_item">
                            
                            <div class="media-body">
                                <a href="blog_details.html">
                                    <h3 style="color: #2d2d2d;">From life was you fish...</h3>
                                </a>
                                <p>January 12, 2019</p>
                            </div>
                        </div>
                        <div class="media post_item">
                            <div class="media-body">
                                <a href="blog_details.html">
                                    <h3 style="color: #2d2d2d;">The Amazing Hubble</h3>
                                </a>
                                <p>02 Hours ago</p>
                            </div>
                        </div>
                        <div class="media post_item">
                            <div class="media-body">
                                <a href="blog_details.html">
                                    <h3 style="color: #2d2d2d;">Astronomy Or Astrology</h3>
                                </a>
                                <p>03 Hours ago</p>
                            </div>
                        </div>
                        <div class="media post_item">
                            <img src="assets/img/post/post_4.png" alt="post">
                            <div class="media-body">
                                <a href="blog_details.html">
                                    <h3 style="color: #2d2d2d;">Asteroids telescope</h3>
                                </a>
                                <p>01 Hours ago</p>
                            </div>
                        </div>
                    </aside>
                    <aside class="single_sidebar_widget tag_cloud_widget">
                        <h4 class="widget_title" style="color: #2d2d2d;">Tag Clouds</h4>
                        <ul class="list">
                            <li>
                                <a href="#">project</a>
                            </li>
                            <li>
                                <a href="#">love</a>
                            </li>
                            <li>
                                <a href="#">technology</a>
                            </li>
                            <li>
                                <a href="#">travel</a>
                            </li>
                            <li>
                                <a href="#">restaurant</a>
                            </li>
                            <li>
                                <a href="#">life style</a>
                            </li>
                            <li>
                                <a href="#">design</a>
                            </li>
                            <li>
                                <a href="#">illustration</a>
                            </li>
                        </ul>
                    </aside>

                    <aside class="single_sidebar_widget instagram_feeds">
                        <h4 class="widget_title" style="color: #2d2d2d;">Instagram Feeds</h4>
                        <ul class="instagram_row flex-wrap">
                            <li>
                                <a href="#">
                                    <img class="img-fluid" src="assets/img/post/post_5.png" alt="">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img class="img-fluid" src="assets/img/post/post_6.png" alt="">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img class="img-fluid" src="assets/img/post/post_7.png" alt="">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img class="img-fluid" src="assets/img/post/post_8.png" alt="">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img class="img-fluid" src="assets/img/post/post_9.png" alt="">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img class="img-fluid" src="assets/img/post/post_10.png" alt="">
                                </a>
                            </li>
                        </ul>
                    </aside>
                    <aside class="single_sidebar_widget newsletter_widget">
                        <h4 class="widget_title" style="color: #2d2d2d;">Newsletter</h4>
                        <form action="#">
                            <div class="form-group">
                                <input type="email" class="form-control" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter email'" placeholder="Enter email" required="">
                            </div>
                            <button class="button rounded-0 primary-bg text-white w-100 btn_1 boxed-btn" type="submit">Subscribe</button>
                        </form>
                    </aside>
                </div>
            </div>
        </div>
    </div>
</section>

 @section Scripts{
<script>
    loadArtical();
        async function searchByTag(tag) {
            document.getElementById("div_article").innerHTML = `<span class="visually-hidden">Loading...</span>`;

            const response = await fetch(`@Url.Content("~/Forum/SearchByTag?tag=${tag}")`)
            const data = await response.json();

            var html = data.map(x => {
                console.log(x);
                const title = x.fTitle;
                const main = x.fMain;
                const date = x.fDate;
                const id = x.fPostId;
                var tag = x.fTag;
                return `<article class="blog_item  gray-bg">
                                                        <div class="blog_details">
                                                                            <button class="genric-btn info large" onclick="redirectToPage(${id})"><a src="~/Forum/PostDetail?${id}">${date}</button>
                                                                 <a class="d-inline-block"  src="~/Forum/PostDetail?${id}">
                                                                                 <h3 class=" blog-head " onclick="redirectToPage(${id})" style="color: #2d2d2d;">${title}</h3>
                                                            </a>
                                                            <p>
                                                                ${main}
                                                            </p>
                                                            <ul class="blog-info-link">
                                                                <li><a href="#"><i class="fa fa-user"></i>${tag}</a></li>
                                                                <li><a href="#"><i class="fa fa-comments"></i> 03 Comments</a></li>
                                                            </ul>
                                                        </div>
                                                 </article>
                                                 `;
            })
            document.getElementById("div_article").innerHTML += html.join("");
            //加載完把讀取動畫關掉
            $(".spinner-border").remove();
        }

        async function searchByKeyword(){
            var keyword = document.getElementById("keyword").value;
            document.getElementById("div_article").innerHTML =`<span class="visually-hidden">Loading...</span>`;

            const response = await fetch(`@Url.Content("~/Forum/Search?keyword=${keyword}")`)
            const data = await response.json();

            var html = data.map(x => {
                console.log(x);
                const title = x.fTitle;
                const main = x.fMain;
                const date = x.fDate;
                const id = x.fPostId;
                var tag = x.fTag;
                return `<article class="blog_item  gray-bg">
                                                <div class="blog_details">
                                                                    <button class="genric-btn info large" onclick="redirectToPage(${id})"><a src="~/Forum/PostDetail?${id}">${date}</button>
                                                         <a class="d-inline-block"  src="~/Forum/PostDetail?${id}">
                                                                         <h3 class=" blog-head " onclick="redirectToPage(${id})" style="color: #2d2d2d;">${title}</h3>
                                                    </a>
                                                    <p>
                                                        ${main}
                                                    </p>
                                                    <ul class="blog-info-link">
                                                        <li><a href="#"><i class="fa fa-user"></i>${tag}</a></li>
                                                        <li><a href="#"><i class="fa fa-comments"></i> 03 Comments</a></li>
                                                    </ul>
                                                </div>
                                         </article>
                                         `;
            })
            document.getElementById("div_article").innerHTML += html.join("");
            //加載完把讀取動畫關掉
            $(".spinner-border").remove();
        }

    async function loadArtical(){
            const response = await fetch(`@Url.Content("~/Forum/GetHistoryPost")`);
            const data = await response.json();

            var html = data.map(x => {
                        console.log(x);
                        const title = x.fTitle;
                        const main = x.fMain;
                        const date = x.fDate;
                        const id = x.fPostId;
                        var tag = x.fTag;
                        return `<article class="blog_item  gray-bg">
                                        <div class="blog_details">
                                                            <button class="genric-btn info large" onclick="redirectToPage(${id})"><a src="~/Forum/PostDetail?${id}">${date}</button>
                                                 <a class="d-inline-block"  src="~/Forum/PostDetail?${id}">
                                                                 <h3 class=" blog-head " onclick="redirectToPage(${id})" style="color: #2d2d2d;">${title}</h3>
                                            </a>
                                            <p>
                                                ${main}
                                            </p>
                                            <ul class="blog-info-link">
                                                <li><a href="#"><i class="fa fa-user"></i>${tag}</a></li>
                                                <li><a href="#"><i class="fa fa-comments"></i> 03 Comments</a></li>
                                            </ul>
                                        </div>
                                 </article>
                                 `;
                           })
            document.getElementById("div_article").innerHTML += html.join("");
            //加載完把讀取動畫關掉
            $(".spinner-border").remove();
         }

    function redirectToPage(id){
        location.href = `\PostDetail\\${id}`;
    }



</script>

 }