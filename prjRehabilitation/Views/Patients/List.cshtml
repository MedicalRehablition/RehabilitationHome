@model IEnumerable<prjRehabilitation.ViewModel.Lin.VMPatientList>

@{
    ViewData["Title"] = "List";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.6.3.js" integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM=" crossorigin="anonymous"></script>

<style>
    body{
        padding:initial;
        margin:initial;
    }
    .box {
        float:left;
        width: 95rem;
        height: 95rem;
        display: flex;
        margin: 0;
        padding:0;
    }

    iframe {
        width: 100rem;
        height: 100rem;
    }

    .divhead {
        margin: 10px;
        display: flex;
        justify-content: space-around;
    }

    .sidebar {
        width: 12rem;
        top: 5rem;
        display: block !important;
        height: calc(100vh - 6rem);
        padding-left: .25rem;
        margin-left: -.25rem;
        overflow-y: auto;
    }
</style>
<div class="box overflow-hidden" style="position:absolute">
    <a class="btn btn-primary" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample">
        |+|
    </a>
    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel" style="width:15rem">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasExampleLabel">住民列表</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div>
                <a asp-action="Create_F" class="btn btn-primary">新增住民</a>
            </div>
            <div class="dropdown mt-3">
                <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                    Dropdown button
                </button>
                <ul class="nav nav-pills nav-flush flex-column mb-auto text-center" id="ul" style="width:10rem">
                    @{
                        foreach (var item in Model)
                        {
                            string imgSrc = "";
                            if (item.fphoto != null)
                            {
                                var base64 = Convert.ToBase64String(item.fphoto);
                                imgSrc = String.Format("data:image/gif;base64,{0}", base64);
                            }
                            <li class="nav-item mb-2">
                                @if (!string.IsNullOrEmpty(imgSrc))
                                {
                                    <img class="card-img-top" src="@imgSrc" alt="顯示錯誤" width="200" height="100" />
                                }
                                else
                                {
                                    <img class="card-img-top" src="~/images/imageDefault.png" width="200" height="100" />
                                }
                                <div class="card-body">
                                    <h5 class="card-title">@item.fName</h5>
                                    <p class="card-text col">
                                        <button class="btn btn-primary " onclick="showiframe(event)" id="@item.fid">編輯</button>
                                        @Html.ActionLink("刪除", "Delete", new { id=item.fid },new { @class="btn btn-danger",onclick = "return confirm('是否刪除?')"})
                                    </p>
                                </div>
                            </li>
                        }
                    }
                </ul>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="#">Action</a></li>
                    <li><a class="dropdown-item" href="#">Another action</a></li>
                    <li><a class="dropdown-item" href="#">Something else here</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="box">
        <iframe name="view" id="view" marginwidth="0" marginheight="0" scrolling="No" frameborder="0" ></iframe>
    </div>




</div>

@section Scripts{
    <script>
        var iframe = document.getElementById("view");
        var turn = false;

        reset();

        function reset(){
                iframe.src = `@Url.Content("~/Patients/patients")`;
        }
        
        function showiframe(event) {
            var id = event.target.id;
            iframe.src = `@Url.Content("~/Patients/Edit/${id}")`;
            console.log(document.getElementById("view").src);
         }



    </script>
}